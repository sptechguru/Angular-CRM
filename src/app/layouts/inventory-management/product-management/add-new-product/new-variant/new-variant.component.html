<ngx-spinner bdColor="rgba(51,51,51,0.8)" color="#fff"
    template="<img src='https://i.gifer.com/origin/b4/b4d657e7ef262b88eb5f7ac021edda87.gif' style='width:100px;' />">
</ngx-spinner>
<div class="py-2">
    <div class="p-3 form-shadow">
        <div class="row">
            <div class="col-12">
                <h2>Product Varient</h2>
            </div>

            <div class="col-12">
                <form [formGroup]="varientForm">
                    <div class="form-shadow" formArrayName="varientlist"
                        *ngIf="varientForm.get('varientlist')?.controls.length > 0">
                        <div *ngFor="let i of varientForm?.controls.varientlist?.controls;let j=index">
                            <div class="p-3" [formGroupName]="j">
                                <div class="row">
                                    <div class="col-12">
                                        <div class="text-right  pl-2">
                                            <div class="d-inline">
                                                <i class="material-icons cp" (click)="copy(j)">file_copy</i>
                                            </div>
                                            <div class="d-inline ml-3"
                                                *ngIf="varientForm.controls.varientlist.controls.length > 1">
                                                <i class="material-icons text-danger cp"
                                                    (click)="deleteVarient(j)">delete</i>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div>
                                            <mat-form-field appearance="outline" class="example-full-width">
                                                <mat-label>Varient Name</mat-label>
                                                <input type="text" matInput formControlName="variant_name">
                                            </mat-form-field>
                                            <div *ngIf="varientForm.controls.varientlist.controls[j].controls.variant_name.invalid 
                                                && (varientForm.controls.varientlist.controls[j].controls.variant_name.dirty 
                                                || varientForm.controls.varientlist.controls[j].controls.variant_name.touched)"
                                                class="error">
                                                <mat-error
                                                    *ngIf="varientForm.controls.varientlist.controls[j].controls.variant_name.errors.required">
                                                    Please enter product variant name
                                                </mat-error>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Base Price </mat-label>
                                            <input type="number" formControlName="base_price" matInput
                                                placeholder="Base Price" min="1" (keyup)="getBasePrice()" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.base_price.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.base_price.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.base_price.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.base_price.errors.required">
                                                Please enter base price
                                            </mat-error>
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.base_price.value!=null &&  varientForm.controls.varientlist.controls[j].controls.base_price?.errors?.negative">
                                                Please enter base price greater than 0.
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>GST Text Type Class</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="gst_tax_type_class_id" matInput
                                                placeholder="GST Text Type Class">
                                                <mat-option [value]="taxTypeClass.id" *ngFor="let taxTypeClass of taxTypeClassList; 
                                            index as i;">{{taxTypeClass.gst_tax_type_code}}</mat-option>
                                            </mat-select>

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.gst_tax_type_class_id.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.gst_tax_type_class_id.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.gst_tax_type_class_id.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.gst_tax_type_class_id.errors.required">
                                                Please select GST text type class
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Max Retail Price</mat-label>
                                            <input type="number" formControlName="max_retail_price" matInput min="1"
                                                placeholder="Max Retail Price" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.max_retail_price.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.max_retail_price.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.max_retail_price.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.max_retail_price.errors.required">
                                                Please enter max retail price
                                            </mat-error>
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.max_retail_price.value!=null &&  varientForm.controls.varientlist.controls[j].controls.max_retail_price?.errors?.negative">
                                                Please enter max retail price greater than 0.
                                            </mat-error>
                                        </div>
                                    </div>


                                    <div class="col-md-6">
                                        <label *ngIf="group_status" style="font-size: 11px;margin-bottom: -6px;margin-left: 12px;  position: absolute;margin-top: -3px;
                                    ">User Group Percentage</label>
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label *ngIf="!group_status">User Group Percentage</mat-label>
                                            <mat-label *ngIf="group_status">{{group_per}}%</mat-label>
                                            <mat-select formControlName="group_percentage" matInput>
                                                <!-- <mat-option class="bg-primary text-white"> {{group_per}}%</mat-option> -->
                                                <mat-option *ngFor="let i of price;index as j;" [value]="i.value"
                                                    (click)="getPrice()">
                                                    {{i.name}}%
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>


                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Max Base Price</mat-label>
                                            <input type="text" formControlName="max_base_price" matInput
                                                [(ngModel)]="priceshow" readonly />
                                        </mat-form-field>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Package Quantity</mat-label>
                                            <input type="number" formControlName="package_quantity" matInput min="1"
                                                placeholder="Package Quantity" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.package_quantity.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.package_quantity.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.package_quantity.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.package_quantity.errors.required">
                                                Please enter package quantity
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Package Availability</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="package_avaibility" matInput
                                                placeholder="Package Availability">
                                                <mat-option value="yes">yes</mat-option>
                                                <mat-option value="no">no</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.package_avaibility.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.package_avaibility.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.package_avaibility.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.package_avaibility.errors.required">
                                                Please enter package availability
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Minimum Order Quantity</mat-label>
                                            <input type="number" formControlName="minimum_order_quantity" matInput
                                                min="1" placeholder="Minimum Order Quantity" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.minimum_order_quantity.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.minimum_order_quantity.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.minimum_order_quantity.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.minimum_order_quantity.errors.required">
                                                Please enter minimum order quantity
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Color Map</mat-label>
                                            <input type="text" formControlName="color_map" matInput
                                                placeholder="Color Map" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.color_map.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.color_map.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.color_map.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.color_map.errors.required">
                                                Please enter color map
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Display Dimension (cm)</mat-label>
                                            <input type="text" formControlName="display_dimension" matInput
                                                placeholder="10*10*10" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.display_dimension.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.display_dimension.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.display_dimension.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.display_dimension.errors.required">
                                                Please enter display dimension
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Display packaging Dimension (cm)</mat-label>
                                            <input type="text" formControlName="display_dimension_with_packing" matInput
                                                placeholder="10*10*10" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.display_dimension_with_packing.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.display_dimension_with_packing.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.display_dimension_with_packing.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.display_dimension_with_packing.errors.required">
                                                Please enter display dimension with packaging
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Weight (gm)</mat-label>
                                            <input type="number" formControlName="weight" matInput min="1"
                                                placeholder="Weight (gm)" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.weight.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.weight.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.weight.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.weight.errors.required">
                                                Please enter weight
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Packaging Weight (gm)</mat-label>
                                            <input type="number" formControlName="weight_with_packing" min="1" matInput
                                                placeholder="Packaging Weight (gm)" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.weight_with_packing.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.weight_with_packing.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.weight_with_packing.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.weight_with_packing.errors.required">
                                                Please enter weight with packaging
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>HSN Code</mat-label>
                                            <input type="number" ng-trim="false" formControlName="hsn_code" matInput
                                                placeholder="HSN Code" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.hsn_code.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.hsn_code.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.hsn_code.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.hsn_code.errors.required">
                                                Please enter HSN code
                                            </mat-error>
                                        </div>
                                    </div>

                                    <!-- <div class="col-md-6" *ngIf="!editProductId > 0">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Quantity</mat-label>
                                            <input type="number" ng-trim="false" formControlName="quantity" matInput
                                                placeholder="Quantity" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.quantity.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.quantity.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.quantity.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.quantity.errors.required">
                                                Please enter Quantity
                                            </mat-error>
                                        </div>
                                    </div>
                                    <div class="col-md-6" *ngIf="editProductId > 0">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Quantity</mat-label>
                                            <input type="number" ng-trim="false" formControlName="quantity" matInput
                                                placeholder="Quantity"[readonly]="true" />
                                        </mat-form-field> -->
                                    <!-- <div *ngIf="varientForm.controls.varientlist.controls[j].controls.quantity.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.quantity.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.quantity.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.quantity.errors.required">
                                                Please enter Quantity
                                            </mat-error> 
                                        </div>
                                    </div>-->
                                    <!--- <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>SKU Code</mat-label>
                                            <input matInput  type="text" formControlName="product_sku"/>
                                        </mat-form-field>
                                    </div>
                                -->
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Product Youtube Link</mat-label>
                                            <input type="text" formControlName="youtube_link" matInput
                                                placeholder="Product Youtube Link" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.youtube_link.invalid 
                                                          && (varientForm.controls.varientlist.controls[j].controls.youtube_link.dirty 
                                                          || varientForm.controls.varientlist.controls[j].controls.youtube_link.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.youtube_link.errors.pattern">
                                                Please enter valid product youtube link
                                            </mat-error>
                                        </div>
                                    </div>
                                    <!-- <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Sample Revervation Stock</mat-label>
                                            <input type="number" formControlName="reserve_stock" matInput
                                                placeholder="Sample Revervation Stock" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.reserve_stock.invalid 
                                                          && (varientForm.controls.varientlist.controls[j].controls.reserve_stock.dirty 
                                                          || varientForm.controls.varientlist.controls[j].controls.reserve_stock.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.reserve_stock.errors.required">
                                                Please enter Reserve Stock Quantity
                                            </mat-error>
                                        </div>
                                    </div> -->
                                    <!----
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <input formControlName="reserve_stock" matInput placeholder="Reserve Stock"
                                                type="number" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.reserve_stock.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.reserve_stock.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.reserve_stock.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.reserve_stock.errors.required">
                                                Please enter reserve stock
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <input formControlName="minimum_quantity_of_reserve_stock" matInput
                                                placeholder="Minimum Qty of Reserve Stock" type="number" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.minimum_quantity_of_reserve_stock.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.minimum_quantity_of_reserve_stock.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.minimum_quantity_of_reserve_stock.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.minimum_quantity_of_reserve_stock.errors.required">
                                                Please enter minimum quantity of reserve stock
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <input formControlName="reserve_stock_dishpatch_time" matInput
                                                placeholder="Reserve Stock Dispatch Time" type="number" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.reserve_stock_dishpatch_time.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.reserve_stock_dishpatch_time.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.reserve_stock_dishpatch_time.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.reserve_stock_dishpatch_time.errors.required">
                                                Please enter reserve stock dispatch time
                                            </mat-error>
                                        </div>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <input formControlName="live_stock_dishpatch_time" matInput
                                                placeholder="Ready Stock Time in Days" type="number" />
                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.live_stock_dishpatch_time.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.live_stock_dishpatch_time.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.live_stock_dishpatch_time.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.live_stock_dishpatch_time.errors.required">
                                                Please enter ready dispatch time
                                            </mat-error>
                                        </div>
                                    </div>
                                -->
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Sample Availability</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="sample_availability"
                                                (selectionChange)="setSampleAbility($event,j)">
                                                <mat-option value="yes">Yes</mat-option>
                                                <mat-option value="no">No</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <!-- <div class="col-md-6" *ngIf="varientForm.controls.varientlist.controls[j].controls.sample_availability.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <input type="number" formControlName="sample_price" matInput
                                                placeholder="Sample Price" min="1" />

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.sample_price.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.sample_price.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.sample_price.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.sample_price.errors.required">
                                                Please enter sample price
                                            </mat-error>
                                        </div>
                                    </div> -->
                                    <!-- <div class="col-md-6" *ngIf="varientForm.controls.varientlist.controls[j].controls.sample_availability.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Sample Price Tax</mat-label>
                                            <input type="number" formControlName="sample_price_tax" matInput
                                                placeholder="Sample Price Tax" min="1" />

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.sample_price_tax.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.sample_price_tax.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.sample_price_tax.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.sample_price_tax.errors.required">
                                                Please enter sample price tax
                                            </mat-error>
                                        </div>
                                    </div> -->

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Customisation Possible</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="customisation_possible"
                                                (selectionChange)="setCustomisation($event,j)">
                                                <mat-option value="yes">Yes</mat-option>
                                                <mat-option value="no">No</mat-option>

                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-6"
                                        *ngIf="varientForm.controls.varientlist.controls[j].controls.customisation_possible.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Type of Customisation </mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="customisation_type">
                                                <mat-option value="Engraving">Engraving</mat-option>
                                                <mat-option value="Screen Print">Screen Print</mat-option>
                                                <mat-option value="Digital print">Digital print</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-6"
                                        *ngIf="varientForm.controls.varientlist.controls[j].controls.customisation_possible.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Customisation Sample</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="customisation_sample">
                                                <mat-option value="yes">Yes</mat-option>
                                                <mat-option value="no">No</mat-option>

                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-6"
                                        *ngIf="varientForm.controls.varientlist.controls[j].controls.customisation_possible.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Customisation Position</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="customisation_position">
                                                <mat-option value="Left">Left</mat-option>
                                                <mat-option value="Right Centre">Right Centre</mat-option>
                                                <mat-option value="Top right">Top right</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-6"
                                        *ngIf="varientForm.controls.varientlist.controls[j].controls.customisation_possible.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">

                                            <mat-label>Customisation Location </mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="customisation_location">
                                                <mat-option value="On Box">On Box</mat-option>
                                                <mat-option value="On Product">On Product</mat-option>
                                                <mat-option value="On Flap">On Flap</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>

                                    <div class="col-md-6"
                                        *ngIf="varientForm.controls.varientlist.controls[j].controls.customisation_possible.value=='yes'">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Customisation Cost </mat-label>

                                            <input formControlName="customisation_cost" matInput
                                                placeholder="Customisation Cost" type="number" />
                                        </mat-form-field>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>View Flat Price</mat-label>
                                            <mat-select formControlName="view_flat_price">
                                                <mat-option value="yes">Yes</mat-option>
                                                <mat-option value="no">No</mat-option>

                                            </mat-select>
                                        </mat-form-field>
                                    </div>

                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Minimum Order Quantity For Ready stock</mat-label>
                                            <input type="number" formControlName="moq_ready_stock" matInput
                                                placeholder="Minimum Order Quantity For Ready stock" min="1" />

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_ready_stock.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.moq_ready_stock.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.moq_ready_stock.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_ready_stock.errors.required">
                                                Please enter Minimum Order Quantity For Ready stock </mat-error>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Minimum Order Quantity Made For Order</mat-label>
                                            <input type="number" formControlName="moq_made_for_order" matInput
                                                placeholder="Minimum Order Quantity Made For Order" min="1" />

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_made_for_order.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.moq_made_for_order.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.moq_made_for_order.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_made_for_order.errors.required">
                                                Please enter Minimum Order Quantity Made For Order
                                            </mat-error>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Minimum Order Quantity For Customisation Order</mat-label>
                                            <input type="number" formControlName="moq_customisation_order" matInput
                                                placeholder="Minimum Order Quantity For Customisation Order" min="1" />

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_customisation_order.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.moq_customisation_order.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.moq_customisation_order.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_customisation_order.errors.required">
                                                Please enter Minimum Order Quantity For Customisation Order
                                            </mat-error>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Minimum Order Quantity For Customised Box</mat-label>
                                            <input type="number" formControlName="moq_customised_box" matInput
                                                placeholder="Minimum Order Quantity For Customised Box" min="1" />

                                        </mat-form-field>
                                        <div *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_customised_box.invalid 
                                        && (varientForm.controls.varientlist.controls[j].controls.moq_customised_box.dirty 
                                        || varientForm.controls.varientlist.controls[j].controls.moq_customised_box.touched)"
                                            class="error">
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.moq_customised_box.errors.required">
                                                Please enter Minimum Order Quantity For Customised Box
                                            </mat-error>
                                        </div>
                                    </div>


                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Status</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="status">
                                                <mat-option value="active">Active</mat-option>
                                                <mat-option value="inactive">Inactive</mat-option>

                                            </mat-select>
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.status.touched && varientForm.controls.varientlist.controls[j].controls.status.errors?.required"
                                                required>Please select Status. </mat-error>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-6">
                                        <mat-form-field class="example-full-width" appearance="outline">
                                            <mat-label>Default</mat-label>
                                            <mat-select disableOptionCentering panelClass="myPanelClass"
                                                formControlName="default" (selectionChange)="defaultChanges($event,j)">
                                                <mat-option value="yes">Yes</mat-option>
                                                <mat-option value="no">No</mat-option>

                                            </mat-select>
                                            <mat-error
                                                *ngIf="varientForm.controls.varientlist.controls[j].controls.default.touched && varientForm.controls.varientlist.controls[j].controls.default.errors?.required"
                                                required>Please select Default. </mat-error>
                                        </mat-form-field>
                                    </div>

                                    <div class="col-md-12">
                                        <mat-form-field class="example-chip-list" appearance="outline">
                                            <mat-label>Search tags</mat-label>
                                            <mat-chip-list #chipList aria-label="tag selection">
                                                <ng-container
                                                    *ngIf="varientForm.controls.varientlist?.controls[j]?.controls?.product_tags?.length > 0">
                                                    <mat-chip
                                                        *ngFor="let tag of varientForm?.controls?.varientlist?.controls[j]?.controls?.product_tags?.value; let tagIndex=index;"
                                                        [selectable]="true" [removable]="true"
                                                        (removed)="remove(varientForm?.controls?.varientlist?.controls[j]?.controls?.product_tags, j, tag,tagIndex)">
                                                        {{tag.tag_name}}
                                                        <mat-icon matChipRemove>cancel</mat-icon>
                                                    </mat-chip>
                                                </ng-container>

                                                <input placeholder="Add Tags..." #tagesInput
                                                    [formControl]="search_keyword" [matChipInputFor]="chipList"
                                                    [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                                                    (matChipInputTokenEnd)="add(varientForm?.controls?.varientlist?.controls[j]?.controls?.search_keyword, j, $event)">
                                            </mat-chip-list>

                                        </mat-form-field>


                                    </div>
                                    <!--this.editProductId &&-->
                                    <div class="col-md-12 mb-2" *ngIf="this.variantAttributeList[j]">
                                        <h2>Variant Attribute</h2>
                                        <div class="form-shadow pt-3">
                                            <div class="row mx-0" *ngIf="this.variantAttributeList[j][0]?.length > 0">
                                                <div class="col-12">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th class="font-weight-bold">Attribute Type</th>
                                                                <th class="font-weight-bold">Attribute Value</th>
                                                                <th class="font-weight-bold">Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr style="border-bottom:1px solid rgba(128, 128, 128,0.2);"
                                                                *ngFor="let attribute of this.variantAttributeList[j][0];let attributeIndex=index;">
                                                                <td>{{attribute?.master_product_attribute?.product_attribute
                                                                    ?
                                                                    attribute?.master_product_attribute?.product_attribute
                                                                    : attribute.product_attribute }}</td>
                                                                <td>{{attribute.attribute_value ?
                                                                    attribute.attribute_value :
                                                                    attribute.attribute_values[0].attribute_value}}</td>
                                                                <td><i class="material-icons text-danger cp"
                                                                        (click)="deleteAttribute(j,attributeIndex,attribute?.id ? attribute?.id : attribute.attribute_values[0].id)">delete</i>
                                                                </td>
                                                            </tr>

                                                        </tbody>

                                                    </table>
                                                </div>
                                                <!--- <ng-container *ngFor="let attribute of this.variantAttributeList[j][0];let attributeIndex=index;">
                                                <div class="col-4">
                                                    <h3>{{attribute?.master_product_attribute?.product_attribute ? attribute?.master_product_attribute?.product_attribute : attribute.product_attribute }}</h3>
                                                </div>
                                                <div class="col-4">
                                                   <h3>{{attribute.attribute_value ? attribute.attribute_value : attribute.attribute_values[0].attribute_value}}</h3>
                                                </div>
                                              
                                            </ng-container>
                                        -->
                                            </div>
                                            <div class="row mx-0" formGroupName="attribute">
                                                <div class="col-4">
                                                    <mat-form-field class="example-full-width" appearance="outline">
                                                        <mat-label>Attribute Type</mat-label>
                                                        <mat-select [disableOptionCentering]="true"
                                                            formControlName="attributType">
                                                            <mat-option value="">Select Attribute</mat-option>
                                                            <mat-option [value]="attributeOption.id"
                                                                *ngFor="let attributeOption of attributeOptionList; index as i;">
                                                                {{attributeOption.product_attribute}}</mat-option>

                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-4">
                                                    <mat-form-field class="example-full-width" appearance="outline">
                                                        <mat-label>Attribute Value</mat-label>
                                                        <input type="text" formControlName="attribute_value" matInput
                                                            placeholder="Attribute Value" />

                                                    </mat-form-field>
                                                </div>
                                                <div class="row mx-0" formGroupName="attribute">
                                                    <div class="col-4">
                                                        <mat-form-field class="example-full-width" appearance="outline">
                                                            <mat-label>Attribute Type</mat-label>
                                                            <mat-select formControlName="attributType">
                                                                <mat-option value="">Select Attribute</mat-option>
                                                                <mat-option [value]="attributeOption.id"
                                                                    *ngFor="let attributeOption of attributeOptionList; index as i;">
                                                                    {{attributeOption.product_attribute}}</mat-option>

                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-4">
                                                        <mat-form-field class="example-full-width" appearance="outline">
                                                            <mat-label>Attribute Value</mat-label>
                                                            <input type="text" formControlName="attribute_value"
                                                                matInput placeholder="Attribute Value" />

                                                        </mat-form-field>
                                                    </div>
                                                    <div class="col-4 mt-2">
                                                        <button mat-flat-button color="warn"
                                                            [disabled]="isUserProcessing" (click)="addAttribute(j)">Add
                                                            Attribute</button>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </div>

                                <mat-divider></mat-divider>
                                <div class="col-md-12">
                                    <label>Variant Description</label>
                                </div>
                                <div class="col-md-12 mb-3">
                                    <!---   <quill-editor formControlName="variant_description" [modules]="modules">
                                </quill-editor>
                            -->
                                    <ckeditor formControlName="variant_description" value="test" [editor]="Editor">
                                    </ckeditor>
                                </div>
                                <div class="col-md-12 ">
                                    <label>Catalogue Description</label>
                                </div>
                                <div class="col-md-12">
                                    <ckeditor formControlName="catalogue_description" [editor]="Editor">
                                    </ckeditor>
                                    <!--- <quill-editor formControlName="catalogue_description" [modules]="modules">
                                </quill-editor>
                            -->
                                </div>

                            </div>
                            <div class="varient_add_button">
                                <button mat-button class="w-100 text-left d-block py-2"
                                    (click)="addVarientOptionName();">
                                    <div class="d-inline-flex">
                                        <mat-icon>add</mat-icon>
                                    </div>
                                    <div class="d-inline-flex align-items-center">Add another option</div>
                                </button>
                            </div>

                        </div>

                    </div>
                </form>

            </div>
            <div class="col-12">
                <div class="d-flex justify-content-between">
                    <button mat-flat-button color="warn" (click)="stepper.previous()">Prev</button>
                    <button mat-flat-button color="warn" (click)="save()">{{editProductId ? 'Update' :'Save' }}</button>
                    <button mat-flat-button color="warn" (click)="stepper.next();">Next</button>
                </div>
            </div>
        </div>

    </div>
</div>